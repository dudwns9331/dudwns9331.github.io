<!DOCTYPE html> <html lang=" en "><head> <meta charset="utf-8" /> <title> 12장 immer를 사용하여 더 쉽게 불변성 유지하기 -ZeroJun's Blog </title> <meta http-equip="X-UA-Compatible" content="IE=edge" /> <meta name="viewport" content="width=device-width, initial-scale=1" /> <meta name="description" content="리액트를 다루는 기술 - velopert- 12장 immer를 사용하여 더 쉽게 불변성 유지하기"> <meta name="keywords" content="12장 immer를 사용하여 더 쉽게 불변성 유지하기, ZeroJun's Blog, React,"/> <link rel="alternate" type="application/rss+xml" title="RSS" href="/feed.xml" /> <meta content="" property="fb:app_id" /> <meta content="ZeroJun's Blog" property="og:site_name" /> <meta content="12장 immer를 사용하여 더 쉽게 불변성 유지하기" property="og:title" /> <meta content="article" property="og:type" /> <meta content="리액트를 다루는 기술 - velopert" property="og:description" /> <meta content="https://dudwns9331.github.io/react/2021/07/08/react12/" property="og:url" /> <meta content="2021-07-08T11:22:12+00:00" property="article:published_time" /> <meta content="https://dudwns9331.github.io/about/" property="article:author" /> <meta content="https://dudwns9331.github.io/assets/img/posts/book.jpg" property="og:image" /> <meta content="React" property="article:section" /> <!-- Twitter Cards --> <meta name="twitter:card" content="summary" /> <meta name="twitter:site" content="@" /> <meta name="twitter:creator" content="@" /> <meta name="twitter:title" content="12장 immer를 사용하여 더 쉽게 불변성 유지하기" /> <meta name="twitter:url" content="https://dudwns9331.github.io/react/2021/07/08/react12/" /> <meta name="twitter:description" content="리액트를 다루는 기술 - velopert" /> <link rel="stylesheet" href="https://dudwns9331.github.io/assets/css/main.css" /> <!-- <link rel="stylesheet" href="https://dudwns9331.github.io/assets/css/custom-style.css" /> --> <link rel="stylesheet" href="https://dudwns9331.github.io/assets/bower_components/lightgallery/dist/css/lightgallery.min.css" /> <link rel="stylesheet" href="https://cdn.snipcart.com/themes/v3.0.0-beta.3/default/snipcart.css" /> <link rel="stylesheet" href="https://dudwns9331.github.io/assets/bower_components/bootstrap/dist/css/bootstrap.min.css" /> <link rel="stylesheet" href="https://dudwns9331.github.io/assets/bower_components/font-awesome/web-fonts-with-css/css/fontawesome-all.min.css" /> <link rel="stylesheet" href="https://dudwns9331.github.io/assets/bower_components/icono/dist/icono.min.css" /> <!-- Fonts--> <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet" /> <!-- Favicon --> <link rel="icon" href="https://dudwns9331.github.io/assets/img/favicon.ico" type="image/gif" sizes="16x16" /> <script> var base_url = 'https://dudwns9331.github.io' ; </script> <!-- Jquery --> <script src="https://code.jquery.com/jquery-3.4.1.min.js" integrity="sha384-vk5WoKIaW/vJyUAd9n/wmopsmNhiy+L2Z+SBxGYnUkunIxVxAv/UtMOhba/xskxh" crossorigin="anonymous" ></script> <!-- <script src="https://dudwns9331.github.io/assets/bower_components/jquery/dist/jquery.min.js"></script> --> <script src="https://dudwns9331.github.io/assets/bower_components/jquery.easing/jquery.easing.min.js"></script> <script src="https://dudwns9331.github.io/assets/bower_components/bootstrap/dist/js/bootstrap.bundle.min.js"></script> <script src="https://dudwns9331.github.io/assets/bower_components/jquery-mousewheel/jquery.mousewheel.min.js"></script> <script src="https://dudwns9331.github.io/assets/bower_components/ghosthunter/dist/jquery.ghostHunter.min.js"></script> <script src="https://dudwns9331.github.io/assets/bower_components/lightgallery/dist/js/lightgallery-all.min.js"></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/picturefill/3.0.2/picturefill.min.js"></script> <script src="https://dudwns9331.github.io/assets/bower_components/imagesloaded/imagesloaded.pkgd.min.js"></script> <script src="https://dudwns9331.github.io/assets/bower_components/nanobar/nanobar.min.js"></script> <script src="https://dudwns9331.github.io/assets/bower_components/typewrite/dist/typewrite.min.js"></script> <script src="https://dudwns9331.github.io/assets/js/search.js"></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.20.1/moment.min.js"></script> <script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script> <!-- for Mathjax support --> <!-- Github Button --> <script async defer src="https://buttons.github.io/buttons.js"></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous" ></script> <!-- (you can remove the below scripts but do buy me a coffee to show some support :) --> <!-- Maker widget --> <!-- <script> (function(d, h, m) { var js, fjs = d.getElementsByTagName(h)[0]; if (d.getElementById(m)) { return; } js = d.createElement(h); js.id = m; js.onload = function() { window.makerWidgetComInit({ position: "left", widget: "ofeeof264otl2l5g-zspk40eq2gaomj2n-higi2qphmveubksi" }); }; js.src = "https://makerwidget.com/js/embed.js"; fjs.parentNode.insertBefore(js, fjs); })(document, "script", "dhm"); </script> --> <!-- buy me a coffeee --> <!-- <script data-name="BMC-Widget" src="https://cdnjs.buymeacoffee.com/1.0.0/widget.prod.min.js" data-id="sujaykundu" data-description="Support me on Buy me a coffee!" data-message="" data-color="#FF813F" data-position="right" data-x_margin="10" data-y_margin="10" ></script> --> <!--[if lt IE 7]> <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]--> <!--[if IE 7]> <html class="no-js lt-ie9 lt-ie8"> <![endif]--> <!--[if IE 8]> <html class="no-js lt-ie9"> <![endif]--> <!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]--> </head> <body><nav class="navbar navbar-expand-lg fixed-top navbar-dark" id="topNav"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation" > <span class="icono-hamburger" id="navbar-hamburger"> </span> </button> <a class="navbar-brand" href="/">ZeroJun's Blog</a> <div class="collapse navbar-collapse" id="navbarNav"> <ul class="navbar-nav"> <li class="nav-item"> <a class="nav-link" href="https://dudwns9331.github.io/" >Home</a > </li> <li class="nav-item"> <a class="nav-link" href="https://dudwns9331.github.io/about" >About</a > </li> <li class="nav-item"> <a class="nav-link" href="https://dudwns9331.github.io/blog" >Blog</a > </li> </ul> </div> <ul class="nav justify-content-end"> <!-- <li class="nav-item"> <a class="nav-link" href="https://dudwns9331.github.io/get-started"> Get Started </a> </li> --> <!-- <li class="nav-item"> <a class="nav-link" id="olvy-target"> What's New </a> </li> --> <!-- <li class="nav-item"> <a class="nav-link" href="https://dudwns9331.github.io/styleguide"> Styleguide </a> </li> --> <!-- <li class="nav-item"> <button id="olvy-target" class="btn btn-dark">What's New</button> </li> --> <li class="nav-item"> <a class="nav-link toggle-search-button" href="#search"> <i class="fa fa-search search-icon" aria-hidden="true"></i> </a> </li> <!-- <li class="nav-item" style="margin-top: 5px; padding-right: 20px"> <a class="header__checkout snipcart-checkout"> <svg width="31" height="27" viewBox="0 0 31 27" fill="none" xmlns="http://www.w3.org/2000/svg" > <path d="M1.10512 0.368718C0.560256 0.368718 0.118164 0.812066 0.118164 1.35848C0.118164 1.9049 0.560256 2.34824 1.10512 2.34824H4.90887L8.30138 18.4009C8.43503 19.0053 8.83085 19.5079 9.32946 19.5041H25.7788C26.3005 19.5118 26.7799 19.0375 26.7799 18.5143C26.7799 17.9911 26.3006 17.5168 25.7788 17.5245H10.1315L9.71003 15.545H27.095C27.5371 15.5412 27.9547 15.2048 28.0511 14.7718L30.354 4.87412C30.4825 4.29933 29.9852 3.67172 29.3979 3.66786H7.21171L6.6771 1.15221C6.58329 0.71276 6.15921 0.368652 5.7107 0.368652L1.10512 0.368718ZM7.623 5.64746H12.7634L13.2569 8.61674H8.25005L7.623 5.64746ZM14.7785 5.64746H20.9881L20.4946 8.61674H15.2719L14.7785 5.64746ZM23.0031 5.64746H28.1537L27.4649 8.61674H22.5097L23.0031 5.64746ZM8.67181 10.5963H13.5862L14.0797 13.5656H9.29919L8.67181 10.5963ZM15.6009 10.5963H20.1656L19.6721 13.5656H16.0944L15.6009 10.5963ZM22.1807 10.5963H27.0023L26.3135 13.5656H21.6872L22.1807 10.5963ZM12.6197 20.164C10.8141 20.164 9.32979 21.6525 9.32979 23.4632C9.32979 25.2739 10.8141 26.7624 12.6197 26.7624C14.4252 26.7624 15.9095 25.2739 15.9095 23.4632C15.9095 21.6525 14.4252 20.164 12.6197 20.164ZM22.4892 20.164C20.6837 20.164 19.1994 21.6525 19.1994 23.4632C19.1994 25.2739 20.6837 26.7624 22.4892 26.7624C24.2948 26.7624 25.7791 25.2739 25.7791 23.4632C25.7791 21.6525 24.2948 20.164 22.4892 20.164ZM12.6197 22.1435C13.3586 22.1435 13.9356 22.7222 13.9356 23.4632C13.9356 24.2042 13.3586 24.7829 12.6197 24.7829C11.8807 24.7829 11.3037 24.2042 11.3037 23.4632C11.3037 22.7222 11.8807 22.1435 12.6197 22.1435ZM22.4892 22.1435C23.2282 22.1435 23.8052 22.7222 23.8052 23.4632C23.8052 24.2042 23.2282 24.7829 22.4892 24.7829C21.7503 24.7829 21.1733 24.2042 21.1733 23.4632C21.1733 22.7222 21.7503 22.1435 22.4892 22.1435Z" fill="#ff7901" class="header__checkout-fill" ></path> </svg> <span class="snipcart-items-count"></span> <span class="snipcart-total-price"></span> </a> </li> --> <li class="nav-item"> <input class="nav-link switch" id="theme-toggle" onclick="modeSwitcher() " type="checkbox" name="checkbox" /> </li> </ul> </nav> <!-- Search Form --> <div class="search-form-container"> <form class="search-form"> <fieldset class="search-form__fieldset"> <div class="row"> <div class="col-lg-8 offset-md-2"> <input class="search-form__field" placeholder="Type to Search..." autofocus /> <input class="search-form__submit" type="submit" value="search" /> </div> </div> </fieldset> </form> <div class="row"> <div class="col-lg-8 offset-md-2 search-results"> <div class="card search-results"></div> </div> </div> <div class="close-search-button search-form-container__close"> <i class="fa fa-times icon"></i> </div> </div> <div class="container"> <div class="row justify-content-center" id="blog-post-container"> <div class="col-lg-10"><article class="card" itemscope itemtype="http://schema.org/BlogPosting"> <div class="card-header"> <h1 class="post-title" itemprop="name headline">12장 immer를 사용하여 더 쉽게 불변성 유지하기</h1> <h4 class="post-meta">리액트를 다루는 기술 - velopert</h4> <p class="post-summary"> Posted by : <span itemprop="author" itemscope itemtype="http://schema.org/Person"> <span itemprop="name" ><a href="https://dudwns9331.github.io/blog/authors/yeongjun" >yeongjun</a ></span > </span > at <time datetime="2021-07-08 11:22:12 +0000" itemprop="datePublished" >Jul 8, 2021</time > </p> <span class="disqus-comment-count" data-disqus-identifier="/react/2021/07/08/react12/" ></span> <div class="post-categories"> Category : <a href="/blog/categories/React" >React</a > </div> </div> <div class="card-body" itemprop="articleBody"> <img class="card-img-top" src="https://dudwns9331.github.io/assets/img/posts/book.jpg" alt="" /> <br /> <br /> <h2 id="2021-07-08">2021-07-08</h2> <h1 id="12장-immer를-사용하여-더-쉽게-불변성-유지하기">12장 immer를 사용하여 더 쉽게 불변성 유지하기</h1> <p><br /></p> <p>11장에서는 컴포넌트 업데이트 성능을 어떻게 최적화해야 하는지, 불변성을 유지하면서 상태를 업데이트하는 것이 왜 중요한지 배웠다. 전개 연산자와 배열 내장 함수를 사용하면 간단하게 배열 혹은 객체를 복사하고 새로운 값을 덮어 쓸 수 있었다. 하지만 객체의 구조가 엄청나게 깊어지면 불변성을 유지하면서 업데이트하는 것이 매우 힘들다.</p> <p><br /></p> <p>실제 프로젝트에서도 복잡한 상태를 다룰 때가 있는데 그럴 때마다 전개 연산자를 사용하여 업데이트 해주면 번거로운 점이 발생할 수 있다. 이럴때 <code class="language-plaintext highlighter-rouge">immer</code>라는 라이브러리를 사용하면 불변성을 유지하면서 업데이트해 줄 수 있다.</p> <p><br /></p> <hr /> <h3 id="121-immer를-설치하고-사용법-알아보기">12.1 immer를 설치하고 사용법 알아보기</h3> <p><br /></p> <div class="language-s highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">$</span><span class="n">yarn</span><span class="w"> </span><span class="n">create</span><span class="w"> </span><span class="n">react</span><span class="o">-</span><span class="n">app</span><span class="w"> </span><span class="n">immer</span><span class="o">-</span><span class="n">tutorial</span><span class="w">
</span><span class="o">$</span><span class="n">cd</span><span class="w"> </span><span class="n">immer</span><span class="o">-</span><span class="n">tutorial</span><span class="w">
</span><span class="o">$</span><span class="n">yarn</span><span class="w"> </span><span class="n">add</span><span class="w"> </span><span class="n">immer</span><span class="w">
</span></code></pre></div></div> <p>다음과같이 <code class="language-plaintext highlighter-rouge">immer-tutorial</code> 앱을 만들고 거기에 <code class="language-plaintext highlighter-rouge">immer</code> 라이브러리를 설치하도록 한다.</p> <p><br /></p> <p>다음은 <code class="language-plaintext highlighter-rouge">immer</code> 라이브러리를 이용해서 불변성을 유지하면서 배열을 업데이트하는 예제를 작성하도록 한다.</p> <p><strong>App.js</strong></p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">useCallback</span><span class="p">,</span> <span class="nx">useRef</span><span class="p">,</span> <span class="nx">useState</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">react</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="dl">'</span><span class="s1">./App.css</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">produce</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">immer</span><span class="dl">'</span><span class="p">;</span>

<span class="kd">function</span> <span class="nx">App</span><span class="p">()</span> <span class="p">{</span>
  <span class="c1">// ID의 값을 지정한다.</span>
  <span class="kd">const</span> <span class="nx">nextId</span> <span class="o">=</span> <span class="nx">useRef</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
  <span class="c1">// form 상태와 form의 상태값을 업데이트하는 변수를 useState를 통해서 작성한다. 상태 : name, username</span>
  <span class="kd">const</span> <span class="p">[</span><span class="nx">form</span><span class="p">,</span> <span class="nx">setForm</span><span class="p">]</span> <span class="o">=</span> <span class="nx">useState</span><span class="p">({</span> <span class="na">name</span><span class="p">:</span> <span class="dl">''</span><span class="p">,</span> <span class="na">username</span><span class="p">:</span> <span class="dl">''</span> <span class="p">});</span>
  <span class="c1">// 리스트에 표시되는 data 배열 상태를 선언하도록 한다.</span>
  <span class="kd">const</span> <span class="p">[</span><span class="nx">data</span><span class="p">,</span> <span class="nx">setData</span><span class="p">]</span> <span class="o">=</span> <span class="nx">useState</span><span class="p">({</span>
    <span class="na">array</span><span class="p">:</span> <span class="p">[],</span>
    <span class="na">uselessValue</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
  <span class="p">});</span>

  <span class="c1">// input 수정을 위한 함수</span>
  <span class="kd">const</span> <span class="nx">onChange</span> <span class="o">=</span> <span class="nx">useCallback</span><span class="p">((</span><span class="nx">e</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="p">{</span> <span class="nx">name</span><span class="p">,</span> <span class="nx">value</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">;</span>
    <span class="nx">setForm</span><span class="p">(</span>
      <span class="nx">produce</span><span class="p">((</span><span class="nx">draft</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="nx">draft</span><span class="p">[</span><span class="nx">name</span><span class="p">]</span> <span class="o">=</span> <span class="nx">value</span><span class="p">;</span>
      <span class="p">})</span>
    <span class="p">);</span>
  <span class="p">},</span> <span class="p">[]);</span>

  <span class="kd">const</span> <span class="nx">onSubmit</span> <span class="o">=</span> <span class="nx">useCallback</span><span class="p">(</span>
    <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="nx">e</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">();</span>
      <span class="kd">const</span> <span class="nx">info</span> <span class="o">=</span> <span class="p">{</span>
        <span class="na">id</span><span class="p">:</span> <span class="nx">nextId</span><span class="p">.</span><span class="nx">current</span><span class="p">,</span>
        <span class="na">name</span><span class="p">:</span> <span class="nx">form</span><span class="p">.</span><span class="nx">name</span><span class="p">,</span>
        <span class="na">username</span><span class="p">:</span> <span class="nx">form</span><span class="p">.</span><span class="nx">username</span><span class="p">,</span>
      <span class="p">};</span>

      <span class="c1">// array에 새 항목 등록</span>
      <span class="nx">setData</span><span class="p">(</span>
        <span class="nx">produce</span><span class="p">((</span><span class="nx">draft</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
          <span class="nx">draft</span><span class="p">.</span><span class="nx">array</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">info</span><span class="p">);</span>
        <span class="p">})</span>
      <span class="p">);</span>

      <span class="nx">setForm</span><span class="p">({</span>
        <span class="na">name</span><span class="p">:</span> <span class="dl">''</span><span class="p">,</span>
        <span class="na">username</span><span class="p">:</span> <span class="dl">''</span><span class="p">,</span>
      <span class="p">});</span>
      <span class="nx">nextId</span><span class="p">.</span><span class="nx">current</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="p">},</span>
    <span class="p">[</span><span class="nx">form</span><span class="p">.</span><span class="nx">name</span><span class="p">,</span> <span class="nx">form</span><span class="p">.</span><span class="nx">username</span><span class="p">]</span>
  <span class="p">);</span>

  <span class="c1">// 항목을 삭제하는 함수</span>

  <span class="kd">const</span> <span class="nx">onRemove</span> <span class="o">=</span> <span class="nx">useCallback</span><span class="p">((</span><span class="nx">id</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">setData</span><span class="p">(</span>
      <span class="nx">produce</span><span class="p">((</span><span class="nx">draft</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="nx">draft</span><span class="p">.</span><span class="nx">array</span><span class="p">.</span><span class="nx">splice</span><span class="p">(</span>
          <span class="nx">draft</span><span class="p">.</span><span class="nx">array</span><span class="p">.</span><span class="nx">findIndex</span><span class="p">((</span><span class="nx">info</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">info</span><span class="p">.</span><span class="nx">id</span> <span class="o">===</span> <span class="nx">id</span><span class="p">),</span>
          <span class="mi">1</span>
        <span class="p">);</span>
      <span class="p">})</span>
    <span class="p">);</span>
  <span class="p">},</span> <span class="p">[]);</span>

  <span class="k">return</span> <span class="p">(</span>
    <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="nx">form</span> <span class="nx">onSubmit</span><span class="o">=</span><span class="p">{</span><span class="nx">onSubmit</span><span class="p">}</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="nx">input</span>
          <span class="nx">name</span><span class="o">=</span><span class="dl">"</span><span class="s2">username</span><span class="dl">"</span>
          <span class="nx">placeholder</span><span class="o">=</span><span class="dl">"</span><span class="s2">아이디</span><span class="dl">"</span>
          <span class="nx">value</span><span class="o">=</span><span class="p">{</span><span class="nx">form</span><span class="p">.</span><span class="nx">username</span><span class="p">}</span>
          <span class="nx">onChange</span><span class="o">=</span><span class="p">{</span><span class="nx">onChange</span><span class="p">}</span>
        <span class="sr">/</span><span class="err">&gt;
</span>        <span class="o">&lt;</span><span class="nx">input</span>
          <span class="nx">name</span><span class="o">=</span><span class="dl">"</span><span class="s2">name</span><span class="dl">"</span>
          <span class="nx">placeholder</span><span class="o">=</span><span class="dl">"</span><span class="s2">이름</span><span class="dl">"</span>
          <span class="nx">value</span><span class="o">=</span><span class="p">{</span><span class="nx">form</span><span class="p">.</span><span class="nx">name</span><span class="p">}</span>
          <span class="nx">onChange</span><span class="o">=</span><span class="p">{</span><span class="nx">onChange</span><span class="p">}</span>
        <span class="sr">/</span><span class="err">&gt;
</span>        <span class="o">&lt;</span><span class="nx">button</span> <span class="nx">type</span><span class="o">=</span><span class="dl">"</span><span class="s2">submit</span><span class="dl">"</span><span class="o">&gt;</span><span class="nx">등록</span><span class="o">&lt;</span><span class="sr">/button</span><span class="err">&gt;
</span>      <span class="o">&lt;</span><span class="sr">/form</span><span class="err">&gt;
</span>
      <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="nx">ul</span><span class="o">&gt;</span>
          <span class="p">{</span><span class="nx">data</span><span class="p">.</span><span class="nx">array</span><span class="p">.</span><span class="nx">map</span><span class="p">((</span><span class="nx">info</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">(</span>
            <span class="o">&lt;</span><span class="nx">li</span> <span class="nx">key</span><span class="o">=</span><span class="p">{</span><span class="nx">info</span><span class="p">.</span><span class="nx">id</span><span class="p">}</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{()</span> <span class="o">=&gt;</span> <span class="nx">onRemove</span><span class="p">(</span><span class="nx">info</span><span class="p">.</span><span class="nx">id</span><span class="p">)}</span><span class="o">&gt;</span>
              <span class="p">{</span><span class="nx">info</span><span class="p">.</span><span class="nx">username</span><span class="p">}</span> <span class="p">({</span><span class="nx">info</span><span class="p">.</span><span class="nx">name</span><span class="p">})</span>
            <span class="o">&lt;</span><span class="sr">/li</span><span class="err">&gt;
</span>          <span class="p">))}</span>
        <span class="o">&lt;</span><span class="sr">/ul</span><span class="err">&gt;
</span>      <span class="o">&lt;</span><span class="sr">/div</span><span class="err">&gt;
</span>    <span class="o">&lt;</span><span class="sr">/div</span><span class="err">&gt;
</span>  <span class="p">);</span>
<span class="p">}</span>

<span class="k">export</span> <span class="k">default</span> <span class="nx">App</span><span class="p">;</span>
</code></pre></div></div> <p><code class="language-plaintext highlighter-rouge">immer에서 제공하는 produce 함수를 호출할 때, 첫 번째 파라미터가 함수 형태라면 업데이트 함수를 반환한다.</code></p> <p><code class="language-plaintext highlighter-rouge">immer</code>를 사용하면 불변성을 유지하는 작업은 매우 간단하게 처리 가능하다. <code class="language-plaintext highlighter-rouge">produce</code>라는 함수는 두 가지 파라미터를 받는다. 첫 번째 파라미터는 수정하고 싶은 상태이고, 두 번째 파라미터는 상태를 어떻게 업데이트할지 정의하는 함수이다.</p> <p><strong>ExampleImmer</strong></p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">immer</span><span class="dl">'</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">nextState</span> <span class="o">=</span> <span class="nx">produce</span><span class="p">(</span><span class="nx">originalState</span><span class="p">,</span> <span class="nx">draft</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="c1">// 바꾸고 싶은 값 바꾸기</span>
    <span class="nx">draft</span><span class="p">.</span><span class="nx">somewhere</span><span class="p">.</span><span class="nx">deep</span><span class="p">.</span><span class="nx">inside</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span>
<span class="p">})</span>
</code></pre></div></div> <p>두 번째 파라미터로 전달되는 함수 내부에서 원하는 값을 변경하면, <code class="language-plaintext highlighter-rouge">produce</code> 함수가 불변성 유지를 대신해 주면서 새로운 상태를 생성해 준다.</p> <p>이 라이브러리의 <code class="language-plaintext highlighter-rouge">핵심은 불변성에 신경쓰지 않는 것처럼 코드를 작성하되 불변성 관리는 제대로 해 주는 것</code>이다.</p> <p><br /></p> <p>배열의 직접적인 변화를 일으키는 push, splice 등의 함수를 사용해도 무방하다. immer를 사용한다고 해서 무조건 코드가 간결해지지는 않는다. onRemove의 경우에는 배열 내장 함수 filter를 사용하는 것이 코드가 더 깔끔하다. <code class="language-plaintext highlighter-rouge">immer는 불변성을 유지하는 코드가 복잡할 때만 사용해도 충분하다.</code></p> <br /><!-- Load Facebook SDK for JavaScript --> <div id="fb-root"></div> <script> (function (d, s, id) { var js, fjs = d.getElementsByTagName(s)[0]; if (d.getElementById(id)) return; js = d.createElement(s); js.id = id; js.src = 'https://connect.facebook.net/en_US/sdk.js#xfbml=1&version=v3.0'; fjs.parentNode.insertBefore(js, fjs); })(document, 'script', 'facebook-jssdk'); </script> <script async src="https://platform.twitter.com/widgets.js" charset="utf-8" ></script> <!-- <div class="share-page"> <p class="share-text">Share this on &rarr;</p> <a href="https://twitter.com/share?ref_src=twsrc%5Etfw" class="twitter-share-button" data-size="large" data-show-count="false" style="margin-top:5px;" >Tweet</a > <a class="fb-share-button" data-href="https://dudwns9331.github.io/react/2021/07/08/react12/" data-size="large" data-layout="button" >Share</a> </div> --> <!-- Author box --> <div class="card"> <div class="card-header"> About YeongJun </div> <div class="card-body"> <div class="row"> <div class="col-md-4"> <img class="author-profile-img" src="https://dudwns9331.github.io/assets/img/authors/yeongjun.png" alt="YeongJun" /> </div> <div class="col-md-6"> <p class="author_bio">Hi I am YeongJun, a Web Developer and Designer.</p> <p>Email : dudwns1045@naver.com</p> <p>Website : http://gitbub.com/dudwns9331</p> <p class="profile-links"> <a class="social-link" href="https://github.com/dudwns9331" target="_blank"><i class="fab fa-github fa-fw"></i></a> <a class="social-link" href="https://instagram.com/ahn0_jun" target="_blank"><i class="fab fa-instagram fa-fw"></i></a> </p> </div> </div> </div> </div> </div> <!--<div class="comments"><script> var disqus_config = function () { this.page.url = "https://dudwns9331.github.io/react/2021/07/08/react12/"; /* Replace PAGE_URL with your page's canonical URL variable */ this.page.identifier = "/react/2021/07/08/react12"; /* Replace PAGE_IDENTIFIER with your page's unique identifier variable */ }; (function () { /* DON'T EDIT BELOW THIS LINE */ var d = document, s = d.createElement("script"); s.src = "https://https-dudwns9331-github-io.disqus.com/embed.js"; s.setAttribute("data-timestamp", +new Date()); (d.head || d.body).appendChild(s); })(); </script> <noscript >Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a> </noscript> </div>--> <!-- 댓글인데 지저분한 광고로 인해서 내림 --> <!-- <div id="disqus_thread"></div> --> </article> <script> var disqus_config = function () { this.page.url = "https://dudwns9331.github.io/react/2021/07/08/react12/"; /* Replace PAGE_URL with your page's canonical URL variable */ this.page.identifier = "/react/2021/07/08/react12"; /* Replace PAGE_IDENTIFIER with your page's unique identifier variable */ }; (function () { /* DON'T EDIT BELOW THIS LINE */ var d = document, s = d.createElement("script"); s.src = "https://https-dudwns9331-github-io.disqus.com/embed.js"; s.setAttribute("data-timestamp", +new Date()); (d.head || d.body).appendChild(s); })(); </script> <noscript >Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a> </noscript> </div> </div> <div class="row"> <div class="col-md-4"> <div class="card"> <div class="card-header">About yeongjun</div> <div class="card-body"> <p class="author_bio">강원대학교 컴퓨터공학과 컴퓨터과학전공 R.O.T.C 60th 127 학군단, 프론트엔드 개발 준비중 :D</p><!-- Place this tag where you want the github button to render. <a class="github-button" href="https://github.com/sujaykundu777/devlopr-jekyll" data-color-scheme="no-preference: dark; light: dark; dark: dark;" data-icon="octicon-star" data-size="large" data-show-count="true" aria-label="Star sujaykundu777/devlopr-jekyll on GitHub" >Star</a > --> </div> </div> </div> <div class="col-md-4"> <div class="card"> <div class="card-header">Categories</div> <div class="card-body text-dark"> <div id="#React"></div> <li class="tag-head"> <a href="/blog/categories/React">React</a> </li> <a name="React"></a> </div> </div> </div> <div class="col-md-4"> <div class="card"> <div class="card-header">Useful Links</div> <div class="card-body text-dark"> <li> <a href="https://dudwns9331.github.io/">Home</a> </li> <li> <a href="https://dudwns9331.github.io/about">About</a> </li> <li> <a href="https://dudwns9331.github.io/blog">Blog</a> </li> </div> </div> </div> </div> </div> <div class="col-lg-12" id="newsletter_footer"><!-- Mailchimp Newletters <form action="" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate > <div id="mc_embed_signup_scroll_footer"> <label for="mce-EMAIL_footer"> Signup for Weekly Email Newsletters :D</label > <input type="email" value="" name="EMAIL" class="email" id="mce-EMAIL_footer" placeholder="email address" required /> real people should not fill this in and expect good things - do not remove this or risk form bot signups <div style="position: absolute; left: -5000px" aria-hidden="true"> <input type="text" name="b_50bab1c85eae24ecfb0f68361_3a2dd721d0" tabindex="-1" value="" /> </div> <br /> <div class="clear"> <input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe_footer" class="btn btn-lg btn-success" /> </div> </div> </form> --> </div><footer> <p> Powered by<a href="https://github.com/sujaykundu777/devlopr-jekyll"> devlopr jekyll</a>.Hosted at <a href="https://pages.github.com">Github</a>. Subscribe via <a href=" /feed.xml ">RSS</a> </p> </footer> <script> var options = { classname: 'progressline', id: 'my-id' }; var nanobar = new Nanobar( options ); nanobar.go( 30 ); nanobar.go( 76 ); nanobar.go(100); </script> <div hidden id="snipcart" data-api-key="Y2I1NTAyNWYtMTNkMy00ODg0LWE4NDItNTZhYzUxNzJkZTI5NjM3MDI4NTUzNzYyMjQ4NzU0"></div> <script src="https://cdn.snipcart.com/themes/v3.0.0-beta.3/default/snipcart.js" defer></script> <script src="https://dudwns9331.github.io/assets/js/mode-switcher.js"></script> <script> if (window.netlifyIdentity) { window.netlifyIdentity.on("init", user => { if (!user) { window.netlifyIdentity.on("login", () => { document.location.href = "/admin/"; }); } }); } </script> <!-- olvy releases --> <script> var OlvyConfig = { organisation: "devlopr", target: "#olvy-target", type: "sidebar", view: { showSearch: true, compact: true, showHeader: true, /* only applies when widget type is embed. you cannot hide header for modal and sidebar widgets */ showUnreadIndicator: true, unreadIndicatorColor: "#FFA13AFF", unreadIndicatorPosition: "top-right" } }; </script> <script type="text/javascript" src="https://app.olvy.co/script.js" defer="defer"></script> </body> </html>
